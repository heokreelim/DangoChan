<!DOCTYPE html>
<html lang="ko" xmlns:th="http://thymeleaf.org" xmlns:sec="http://thymeleaf.org/extras/spring-security">
<head>
    <div th:replace="fragment/head"></div>
    <title>홈페이지</title>
    <script defer th:src="@{/js/calendar.js}"></script>
</head>
<body>
    <div class="page-wrap">
      <div class="left-wrap">
        <div th:replace="fragment/nav"></div>
      </div>  
      <div class="right-wrap">
        <div th:replace="fragment/header"></div>
        <div class="container">
          <div class="service-wrap">
            <div class="category-wrap">
              <input type="hidden" id="userId" th:value="${userId}">
              <!-- 카테고리 없을 경우 -->
              <th:block th:if="${categoryList == null or categoryList.isEmpty()}">
                  <p class="categoryEmpty">
                    하단 플러스(+) 버튼을 클릭하여<br>
                    카테고리를 추가하고 새로운 덱을 생성하세요.
                  </p>
                  <input type="button" id="addCategoryBtn" class="addCategoryBtn btn-open-adding-category-modal" data-userId="" value="&#43;">
              </th:block>
              <!-- 카테고리 있을 경우 -->
              <th:block th:unless="${categoryList == null or categoryList.isEmpty()}">
                <div th:each="category : ${categoryList}">
                  <div class="category">
                    <div class="category-left">
                      <i class="fa-solid fa-folder-open"></i>
                      <span><b th:text="${category.categoryName}">카테고리 명</b></span>
                    </div> <!-- category-left end -->
                    <div class="category-right">
                      <div class="dropdown">
                        <i class="fa-solid fa-ellipsis-vertical menu-icon"></i>
                        <div class="dropdown-menu">
                          <ul>
                            <li><button class="btn-open-editing-category-modal">수정</button></li>
                            <li><button class="">삭제</button></li>
                          </ul>
                        </div>
                      </div>
                      <a th:href="@{/deckList(deckId=${category.categoryId}, userId=${userId})}">
                        <i class="fa-solid fa-chevron-up"></i>
                      </a>
                      <input type="hidden" id="" th:value="${category.categoryId}">
                    </div> <!-- category-right end -->
                  </div>
                  <ul class="deckList" th:each="deck : ${category.deckInfoList}">
                    <li>
                      <div class="deck-wrap">
                        <div class="deck-top">
                          <span><b th:text="${deck.deckName}"></b></span>
                          <div class="dropdown">
                            <i class="fa-solid fa-ellipsis-vertical menu-icon"></i>
                            <div class="dropdown-menu">
                              <ul>
                                <li><button class="btn-exporting-deck">공유</button></li>
                                <li><button class="modal_editing_deck">수정</button></li>
                                <li><button class="">삭제</button></li>
                              </ul>
                            </div>
                          </div>
                        </div>
                        <div class="deck-bottom">
                          <div class="icon-box">
                            <i class="fa-regular fa-circle"></i>
                            <span th:text="${deck.studiedCardCountOk}">○ 갯수 표시</span>
                          </div>  
                          <div class="icon-box">
                            <i class="fa-regular fa-circle"></i>
                            <span th:text="${deck.studiedCardCountYet}">△ 갯수 표시</span>
                          </div>
                          <div class="icon-box">
                            <i class="fa-regular fa-circle"></i>
                            <span th:text="${deck.studiedCardCountNo}">× 갯수 표시</span>
                          </div>
                          <div class="percentage-box">
                            <span class="percentage-text percent50">[[${deck.cardStudyRate}]]%</span>
                            <svg>
                              <circle class="progress" cx="75" cy="75" r="60" />
                            </svg>
                          </div>
                        </div>
                  
                      </div>
                    </li>
                  </ul>
                </div>

              </th:block>
               <!-- category-wrap end -->
                <input type="button" id="addCategoryBtn" class="btn-open-adding-menu-modal addCategoryBtn" data-userId="" value="&#43;">
          </div> <!-- service-wrap end -->
        </div> <!-- container end -->
      </div> <!-- right-wrap end -->
    </div> <!-- page-wrap end -->
</body>
  <div class="modal-wrap">
    <div class="modal_adding_menu">
      <div class="adding_menu">
        <div><!-- 카테고리 생성 버튼 -->
          <label>카테고리
            <br>
            <input type="button" class="btn-open-adding-category-modal" value="카테고리 생성">
          </label>
        </div>
        <br>
        <div> <!-- 덱 생성 버튼 -->
          <p>덱</p>
          <input type="button" class="btn-open-adding-deck-modal" value="덱 생성">
          <input type="button" class="btn-open-importing-deck-modal" value="덱 불러오기">
          <input id="importFile" type="file" />
        </div>
        <div>
          <button type="button" class="btn-close-modal">닫기</button>
        </div>
      </div>
    </div>

    <div class="modal_adding_category">
      <div class="adding_category">
        <form th:action="@{/flashcard/insertCategory}" method="GET">
    
          <h2>카테고리 추가</h2>
          <label>카테고리 :
            <input type="text" name="categoryName" id="categoryName" placeholder="카테고리 이름을 입력해주세요">
          </label><br>
          <input type="submit" value="추가">
          <input type="button" class="btn-close-modal" value="닫기">
        </form>
      </div>
    </div>

    <div class="modal_editing_category">
      <div class="editing_category">
        <form th:action="@{/flashcard/updateCategory}" method="GET">
          <h2>카테고리 편집</h2>
          <!-- html을 처음 불러오면서 모델로 categoryId를 불러와야 함 type="hidden" -->
          <input type="text" name="categoryId" id="categoryId" value="1">
          <label>카테고리 :
            <input type="text" name="categoryName" id="categoryName" placeholder="입력된 카테고리명">
          </label><br>
          <button type="submit">수정</button>
          <input type="button" class="btn-close-modal" value="닫기">
        </form>
      </div>
    </div>
    
    <div class="modal_adding_deck">
      <div class="adding_deck">
        <form>
          <label>덱이름 :
            <input type="text" name="deckName" id="deckName" placeholder="덱 이름을 입력해주세요">
          </label>
          <label>카테고리 :
            <!--  select value 값이 categoryId -->
            <select name="categoryName" id="categoryName" >
              <option value="1">임시1</option>
              <option value="2">임시2</option>
            </select>
          </label>
          <div>
            <table class="card_list">
              <thead>
                <tr>
                  <th>단어</th>
                  <th>품사</th>
                  <th>뜻</th>
                  <th>예문</th>
                  <th>예문 뜻</th>
                  <th>삭제</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>단어</td>
                  <td>품사</td>
                  <td>뜻</td>
                  <td>예문예문예문예문예문예문예문예문예문예문예문</td>
                  <td>예문예문예문예문예문예문예문예문예문예문예문</td>
                  <td><button>🗑</button></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div>
            <input type="button" class="btn-open-adding-card-modal" value="카드 추가">
          </div>
          <br>
          <div>
            <input type="button" class="btn-submit-deck" value="저장">
            <input type="button" class="btn-close-modal" value="닫기">
          </div>
        </form>
      </div>
    </div>
    
    <div class="modal_importing_deck">
      <div class="importing_deck">
        <form>
          <label>덱이름 :
            <input type="text" name="deckName2" id="deckName2" placeholder="덱 이름을 입력해주세요">
          </label>
          <label>카테고리 :
            <select name="categoryName" class="categoryName">
              <option value="1">임시1</option>
              <option value="2">임시2</option>
            </select>
          </label>
          <div class="card_list">
            <table>
              <thead>
                <tr>
                  <th>단어</th>
                  <th>품사</th>
                  <th>뜻</th>
                  <th>예문</th>
                  <th>예문 뜻</th>
                  <th>삭제</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>단어</td>
                  <td>품사</td>
                  <td>뜻</td>
                  <td>예문예문예문예문예문예문예문</td>
                  <td>예문뜻뜻예문예문예문예문예문</td>
                  <td><button>🗑</button></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div>
            <input type="button" class="btn-open-adding-card-modal" value="카드 추가">
          </div>
          <br>
          <div>
            <input type="button" class="btn-submit-deck" value="저장">
            <input type="button" class="btn-close-modal" value="닫기">
          </div>
        </form>
      </div>
    </div>
    
    
    
    
    
    
    
    <div class="modal_editing_deck">
      <div class="editing_deck">
        <form>
          <label>덱 ID:
            <input type="text" id="editDeckId" readonly>
          </label>
          <label>덱이름:
            <input type="text" id="editDeckName">
          </label>
          <label>카테고리:
            <select id="editCategoryName">
              <option value="1">임시1</option>
              <option value="2">임시2</option>
            </select>
          </label>
          <div>
            <table class="edit_card_list">
              <thead>
                <tr>
                  <th>삭제</th>
                  <th>단어</th>
                  <th>품사</th>
                  <th>뜻</th>
                  <th>예문</th>
                  <th>예문 뜻</th>
                </tr>
              </thead>
              <tbody>
                <!-- 카드 데이터 동적 추가 -->
              </tbody>
            </table>
          </div>
          <div>
            <input type="button" class="btn-open-adding-card-to-editing-deck" value="카드 추가">
          </div>
          <br>
          <div>
            <input type="button" class="btn-update-deck" value="수정 완료">
            <input type="button" class="btn-close-modal" value="닫기">
          </div>
        </form>
      </div>
    </div>
    
    <div class="modal_adding_card">
      <div class="adding_card">
        <h2>카드 추가</h2>
        <label>단어: <input type="text" id="cardWord"></label><br>
        <label>품사: <input type="text" id="cardPos"></label><br>
        <label>뜻: <input type="text" id="cardMeaning"></label><br>
        <label>예문 (일본어): <input type="text" id="cardExampleJp"></label><br>
        <label>예문 (한국어): <input type="text" id="cardExampleKr"></label><br>
        <input type="button" class="btn-create-example" value="예문 자동 완성"><br>
        <input type="button" class="btn-add-card-adding" value="추가">
        <input type="button" class="btn-close-modal" value="닫기">
      </div>
    </div>
    
    <div class="modal_adding_card2">
      <div class="adding_card2">
        <h2>카드 추가</h2>
        <label>단어: <input type="text" id="cardWord"></label><br>
        <label>품사: <input type="text" id="cardPos"></label><br>
        <label>뜻: <input type="text" id="cardMeaning"></label><br>
        <label>예문 (일본어): <input type="text" id="cardExampleJp"></label><br>
        <label>예문 (한국어): <input type="text" id="cardExampleKr"></label><br>
        <input type="button" class="btn-create-example" value="예문 자동 완성"><br>
        <input type="button" class="btn-add-card-adding2" value="추가">
        <input type="button" class="btn-close-modal" value="닫기">
      </div>
    </div>
    
    
    <!-- 카드 편집 모달 -->
    <div class="modal_editing_card">
      <div class="editing_card">
        <h2>카드 추가/편집</h2>
        <input type="hidden" id="editCardId"> <!-- 기존 카드 ID 저장 -->
        <label>단어: <input type="text" id="editCardWord"></label><br>
        <label>품사: <input type="text" id="editCardPos"></label><br>
        <label>뜻: <input type="text" id="editCardMeaning"></label><br>
        <label>예문 (일본어): <input type="text" id="editCardExampleJp"></label><br>
        <label>예문 (한국어): <input type="text" id="editCardExampleKr"></label><br>
        <input type="button" class="btn-create-example" value="예문 자동 완성"><br>
        <input type="button" class="btn-save-card" value="저장">
        <input type="button" class="btn-close-modal" value="닫기">
      </div>
    </div>

  </div> <!-- modal-wrap end -->

  
</html>